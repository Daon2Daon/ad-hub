# í”„ë¡œì íŠ¸ êµ¬ì¡° ê°€ì´ë“œ

## ğŸ“‹ ëª©ì°¨

1. [í”„ë¡œì íŠ¸ ê°œìš”](#í”„ë¡œì íŠ¸-ê°œìš”)
2. [ì „ì²´ íŒŒì¼ êµ¬ì¡°](#ì „ì²´-íŒŒì¼-êµ¬ì¡°)
3. [ì• í”Œë¦¬ì¼€ì´ì…˜(App) ì»¨í…Œì´ë„ˆ êµ¬ì¡°](#ì• í”Œë¦¬ì¼€ì´ì…˜app-ì»¨í…Œì´ë„ˆ-êµ¬ì¡°)
4. [ë°ì´í„°ë² ì´ìŠ¤(PostgreSQL) ì»¨í…Œì´ë„ˆ êµ¬ì¡°](#ë°ì´í„°ë² ì´ìŠ¤postgresql-ì»¨í…Œì´ë„ˆ-êµ¬ì¡°)
5. [Docker ì»¨í…Œì´ë„ˆ ê°œë³„ ì—…ë°ì´íŠ¸](#docker-ì»¨í…Œì´ë„ˆ-ê°œë³„-ì—…ë°ì´íŠ¸)
6. [ì£¼ìš” ì„¤ì • íŒŒì¼ ì„¤ëª…](#ì£¼ìš”-ì„¤ì •-íŒŒì¼-ì„¤ëª…)

---

## ğŸ¯ í”„ë¡œì íŠ¸ ê°œìš”

**ad-hub**ì€ Next.js 15 ê¸°ë°˜ì˜ ê´‘ê³  ìº í˜ì¸ ê´€ë¦¬ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

- **í”„ë ˆì„ì›Œí¬**: Next.js 15 (App Router)
- **ì–¸ì–´**: TypeScript
- **ë°ì´í„°ë² ì´ìŠ¤**: PostgreSQL 15
- **ORM**: Prisma
- **ì¸ì¦**: NextAuth.js
- **ìŠ¤íƒ€ì¼ë§**: Tailwind CSS + Shadcn UI
- **ì»¨í…Œì´ë„ˆí™”**: Docker Compose

---

## ğŸ“ ì „ì²´ íŒŒì¼ êµ¬ì¡°

```
ad-hub/
â”œâ”€â”€ src/                          # ì†ŒìŠ¤ ì½”ë“œ
â”‚   â”œâ”€â”€ app/                      # Next.js App Router í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ api/                  # API ë¼ìš°íŠ¸
â”‚   â”‚   â”œâ”€â”€ dashboard/            # ëŒ€ì‹œë³´ë“œ í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ login/                # ë¡œê·¸ì¸ í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ management/           # ìº í˜ì¸ ê´€ë¦¬ í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ masterdata/           # ë§ˆìŠ¤í„° ë°ì´í„° í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ logs/                 # í™œë™ ë¡œê·¸ í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ report/               # ë¦¬í¬íŠ¸ í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ schedule/             # ìŠ¤ì¼€ì¤„ í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ system/               # ì‹œìŠ¤í…œ ì„¤ì • í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ layout.tsx            # ë£¨íŠ¸ ë ˆì´ì•„ì›ƒ
â”‚   â”‚   â””â”€â”€ page.tsx              # í™ˆ í˜ì´ì§€
â”‚   â”œâ”€â”€ components/               # React ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ auth/                 # ì¸ì¦ ê´€ë ¨ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ dashboard/             # ëŒ€ì‹œë³´ë“œ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ layout/                # ë ˆì´ì•„ì›ƒ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ management/            # ê´€ë¦¬ í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ master-data/          # ë§ˆìŠ¤í„° ë°ì´í„° ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ logs/                 # ë¡œê·¸ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ report/               # ë¦¬í¬íŠ¸ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ schedule/             # ìŠ¤ì¼€ì¤„ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ system/               # ì‹œìŠ¤í…œ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â””â”€â”€ ui/                   # Shadcn UI ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ lib/                      # ìœ í‹¸ë¦¬í‹° ë° ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ auth/                 # ì¸ì¦ ê´€ë ¨ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ dashboard/            # ëŒ€ì‹œë³´ë“œ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ logs/                 # ë¡œê·¸ ê´€ë ¨ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ management/           # ê´€ë¦¬ ê¸°ëŠ¥ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ master-data/          # ë§ˆìŠ¤í„° ë°ì´í„° ë¡œì§
â”‚   â”‚   â”œâ”€â”€ report/               # ë¦¬í¬íŠ¸ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ schedule/             # ìŠ¤ì¼€ì¤„ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ system/               # ì‹œìŠ¤í…œ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ logger/               # ë¡œê¹… ìœ í‹¸ë¦¬í‹°
â”‚   â”‚   â”œâ”€â”€ prisma.ts             # Prisma Client ì¸ìŠ¤í„´ìŠ¤
â”‚   â”‚   â””â”€â”€ utils.ts              # ê³µí†µ ìœ í‹¸ë¦¬í‹°
â”‚   â””â”€â”€ types/                    # TypeScript íƒ€ì… ì •ì˜
â”œâ”€â”€ prisma/                       # Prisma ì„¤ì •
â”‚   â”œâ”€â”€ schema.prisma             # ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ
â”‚   â”œâ”€â”€ migrations/               # ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼
â”‚   â””â”€â”€ seed.ts                   # ì´ˆê¸° ë°ì´í„° ì‹œë“œ
â”œâ”€â”€ Dockerfile                    # App ì»¨í…Œì´ë„ˆ ë¹Œë“œ ì„¤ì •
â”œâ”€â”€ docker-compose.yml            # Docker Compose ì„¤ì •
â”œâ”€â”€ entrypoint.sh                 # ì»¨í…Œì´ë„ˆ ì‹œì‘ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ package.json                  # Node.js ì˜ì¡´ì„± ë° ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ next.config.ts                # Next.js ì„¤ì •
â”œâ”€â”€ tsconfig.json                 # TypeScript ì„¤ì •
â”œâ”€â”€ tailwind.config.ts            # Tailwind CSS ì„¤ì •
â””â”€â”€ .env                          # í™˜ê²½ ë³€ìˆ˜ (ë¡œì»¬ ê°œë°œìš©)
```

---

## ğŸš€ ì• í”Œë¦¬ì¼€ì´ì…˜(App) ì»¨í…Œì´ë„ˆ êµ¬ì¡°

### ì»¨í…Œì´ë„ˆ ì •ë³´

- **ì»¨í…Œì´ë„ˆ ì´ë¦„**: `adhub-app`
- **ì„œë¹„ìŠ¤ ì´ë¦„**: `app`
- **í¬íŠ¸ ë§¤í•‘**: `5412:3000` (í˜¸ìŠ¤íŠ¸:ì»¨í…Œì´ë„ˆ)
- **ì´ë¯¸ì§€**: `Dockerfile`ë¡œ ë¹Œë“œëœ ì»¤ìŠ¤í…€ ì´ë¯¸ì§€
- **ê¸°ë°˜ ì´ë¯¸ì§€**: `node:22-alpine`

### ê´€ë ¨ íŒŒì¼

#### 1. **Dockerfile**
- ë©€í‹° ìŠ¤í…Œì´ì§€ ë¹Œë“œë¡œ ìµœì í™”ëœ ì´ë¯¸ì§€ ìƒì„±
- **deps ë‹¨ê³„**: ì˜ì¡´ì„± ì„¤ì¹˜ (`npm ci`)
- **prisma ë‹¨ê³„**: Prisma Client ìƒì„±
- **builder ë‹¨ê³„**: Next.js ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹Œë“œ
- **runner ë‹¨ê³„**: í”„ë¡œë•ì…˜ ëŸ°íƒ€ì„ í™˜ê²½

#### 2. **entrypoint.sh**
- ì»¨í…Œì´ë„ˆ ì‹œì‘ ì‹œ ìë™ ì‹¤í–‰ë˜ëŠ” ìŠ¤í¬ë¦½íŠ¸
- ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ëŒ€ê¸°
- Prisma Client ìƒì„±
- ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰
- ì´ˆê¸° ë°ì´í„° ì‹œë“œ (ê´€ë¦¬ì ê³„ì • ìƒì„±)
- Next.js ì•± ì‹œì‘

#### 3. **package.json**
- í”„ë¡œì íŠ¸ ì˜ì¡´ì„± ì •ì˜
- npm ìŠ¤í¬ë¦½íŠ¸ ì •ì˜
  - `dev`: ê°œë°œ ì„œë²„ ì‹¤í–‰
  - `build`: í”„ë¡œë•ì…˜ ë¹Œë“œ
  - `start`: í”„ë¡œë•ì…˜ ì„œë²„ ì‹œì‘
  - `prisma:migrate`: ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰
  - `prisma:seed`: ì‹œë“œ ë°ì´í„° ì‹¤í–‰

#### 4. **src/app/**
- Next.js App Router ê¸°ë°˜ í˜ì´ì§€ ë° ë¼ìš°íŠ¸
- ê° í˜ì´ì§€ëŠ” `page.tsx` íŒŒì¼ë¡œ ì •ì˜
- API ë¼ìš°íŠ¸ëŠ” `api/` í´ë”ì— ì •ì˜

#### 5. **src/components/**
- React ì»´í¬ë„ŒíŠ¸
- ê¸°ëŠ¥ë³„ë¡œ í´ë” êµ¬ì„±
- UI ì»´í¬ë„ŒíŠ¸ëŠ” `ui/` í´ë”ì— Shadcn UI ê¸°ë°˜

#### 6. **src/lib/**
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë° ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
- Server Actions (ë°ì´í„° ë³€ê²½ ì‘ì—…)
- Prisma Clientë¥¼ í†µí•œ ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼

#### 7. **next.config.ts**
- Next.js ì„¤ì • íŒŒì¼
- ë¹Œë“œ ì˜µì…˜, í™˜ê²½ ë³€ìˆ˜ ë“± ì„¤ì •

### ë¹Œë“œ í”„ë¡œì„¸ìŠ¤

1. **ì˜ì¡´ì„± ì„¤ì¹˜**: `npm ci`ë¡œ ì •í™•í•œ ë²„ì „ ì„¤ì¹˜
2. **Prisma Client ìƒì„±**: `npx prisma generate`
3. **Next.js ë¹Œë“œ**: `npm run build`
4. **ìµœì í™”**: ë©€í‹° ìŠ¤í…Œì´ì§€ ë¹Œë“œë¡œ ìµœì¢… ì´ë¯¸ì§€ í¬ê¸° ìµœì†Œí™”

---

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤(PostgreSQL) ì»¨í…Œì´ë„ˆ êµ¬ì¡°

### ì»¨í…Œì´ë„ˆ ì •ë³´

- **ì»¨í…Œì´ë„ˆ ì´ë¦„**: `ad-hub-postgres-database`
- **ì„œë¹„ìŠ¤ ì´ë¦„**: `postgres`
- **í¬íŠ¸ ë§¤í•‘**: `6709:5432` (í˜¸ìŠ¤íŠ¸:ì»¨í…Œì´ë„ˆ)
- **ì´ë¯¸ì§€**: `postgres:15-alpine`
- **ë°ì´í„° ë³¼ë¥¨**: `./postgres-database` (ë¡œì»¬) ë˜ëŠ” `/volume1/docker/ad-hub/postgres-database` (Synology NAS)

### ê´€ë ¨ íŒŒì¼

#### 1. **prisma/schema.prisma**
- ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì •ì˜
- Prisma ëª¨ë¸ ì •ì˜
- ì£¼ìš” ëª¨ë¸:
  - `User`: ì‚¬ìš©ì ì •ë³´
  - `UserAccessProfile`: ì‚¬ìš©ì ì ‘ê·¼ ê¶Œí•œ í”„ë¡œí•„
  - `Campaign`: ìº í˜ì¸ ë°ì´í„°
  - `MasterDataItem`: ë§ˆìŠ¤í„° ë°ì´í„°
  - `ActivityLog`: í™œë™ ë¡œê·¸
  - `Account`, `Session`, `VerificationToken`: NextAuth ê´€ë ¨

#### 2. **prisma/migrations/**
- ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼
- ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì´ë ¥
- `prisma migrate deploy`ë¡œ ì ìš©

#### 3. **prisma/seed.ts**
- ì´ˆê¸° ë°ì´í„° ì‹œë“œ ìŠ¤í¬ë¦½íŠ¸
- ê´€ë¦¬ì ê³„ì • ìƒì„±
- í™˜ê²½ ë³€ìˆ˜ë¡œ ê´€ë¦¬ì ì •ë³´ ì„¤ì • ê°€ëŠ¥

#### 4. **docker-compose.yml (postgres ì„œë¹„ìŠ¤)**
- PostgreSQL ì»¨í…Œì´ë„ˆ ì„¤ì •
- í™˜ê²½ ë³€ìˆ˜:
  - `POSTGRES_USER`: postgres
  - `POSTGRES_PASSWORD`: í™˜ê²½ ë³€ìˆ˜ì—ì„œ ê°€ì ¸ì˜´
  - `POSTGRES_DB`: adhub
- Health check ì„¤ì •

### ë°ì´í„° ì €ì¥ ìœ„ì¹˜

- **ë¡œì»¬ ê°œë°œ**: `./postgres-database/` (í”„ë¡œì íŠ¸ ë£¨íŠ¸)
- **Synology NAS**: `/volume1/docker/ad-hub/postgres-database/`
- ë°ì´í„°ëŠ” ë³¼ë¥¨ì— ì˜êµ¬ ì €ì¥ë˜ë¯€ë¡œ ì»¨í…Œì´ë„ˆ ì¬ìƒì„± ì‹œì—ë„ ìœ ì§€ë¨

---

## ğŸ”„ Docker ì»¨í…Œì´ë„ˆ ê°œë³„ ì—…ë°ì´íŠ¸

### App ì»¨í…Œì´ë„ˆë§Œ ì—…ë°ì´íŠ¸

ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ ë³€ê²½ ì‹œ App ì»¨í…Œì´ë„ˆë§Œ ì¬ë¹Œë“œí•˜ê³  ì¬ì‹œì‘í•©ë‹ˆë‹¤.

#### ë°©ë²• 1: Docker Compose ì‚¬ìš© (ê¶Œì¥)

```bash
# í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd /volume1/docker/ad-hub  # Synology NAS
# ë˜ëŠ”
cd /path/to/ad-hub         # ë¡œì»¬ ê°œë°œ

# App ì»¨í…Œì´ë„ˆë§Œ ì¬ë¹Œë“œ ë° ì¬ì‹œì‘
docker compose up -d --build app

# ë˜ëŠ” ë‹¨ê³„ë³„ë¡œ ì‹¤í–‰
docker compose stop app          # App ì»¨í…Œì´ë„ˆ ì¤‘ì§€
docker compose build app         # App ì´ë¯¸ì§€ ì¬ë¹Œë“œ
docker compose up -d app         # App ì»¨í…Œì´ë„ˆ ì‹œì‘
```

#### ë°©ë²• 2: Docker ëª…ë ¹ì–´ ì§ì ‘ ì‚¬ìš©

```bash
# App ì»¨í…Œì´ë„ˆ ì¤‘ì§€ ë° ì œê±°
docker stop adhub-app
docker rm adhub-app

# ì´ë¯¸ì§€ ì¬ë¹Œë“œ
docker compose build app

# ì»¨í…Œì´ë„ˆ ì‹œì‘
docker compose up -d app
```

#### ë°©ë²• 3: ì½”ë“œ ë³€ê²½ í›„ ìë™ ì¬ì‹œì‘

```bash
# ì½”ë“œ ë³€ê²½ í›„
docker compose restart app
```

**âš ï¸ ì£¼ì˜ì‚¬í•­:**
- App ì»¨í…Œì´ë„ˆë§Œ ì¬ì‹œì‘í•˜ë©´ ë°ì´í„°ë² ì´ìŠ¤ëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€ë©ë‹ˆë‹¤
- ë§ˆì´ê·¸ë ˆì´ì…˜ì´ í•„ìš”í•œ ê²½ìš° `entrypoint.sh`ê°€ ìë™ìœ¼ë¡œ ì‹¤í–‰í•˜ê±°ë‚˜ ìˆ˜ë™ ì‹¤í–‰:
  ```bash
  docker exec -it adhub-app npx prisma migrate deploy
  ```

### ë°ì´í„°ë² ì´ìŠ¤ ì»¨í…Œì´ë„ˆë§Œ ì—…ë°ì´íŠ¸

ë°ì´í„°ë² ì´ìŠ¤ ë²„ì „ ì—…ê·¸ë ˆì´ë“œë‚˜ ì„¤ì • ë³€ê²½ ì‹œ ì‚¬ìš©í•©ë‹ˆë‹¤.

#### ë°©ë²• 1: Docker Compose ì‚¬ìš© (ê¶Œì¥)

```bash
# PostgreSQL ì»¨í…Œì´ë„ˆë§Œ ì¬ì‹œì‘
docker compose restart postgres

# ë˜ëŠ” ì¬ìƒì„± (ë°ì´í„°ëŠ” ë³¼ë¥¨ì— ë³´ì¡´ë¨)
docker compose up -d --force-recreate postgres
```

#### ë°©ë²• 2: PostgreSQL ë²„ì „ ì—…ê·¸ë ˆì´ë“œ

```bash
# 1. ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—… (ì¤‘ìš”!)
docker exec ad-hub-postgres-database pg_dump -U postgres adhub > backup_$(date +%Y%m%d).sql

# 2. docker-compose.ymlì—ì„œ ì´ë¯¸ì§€ ë²„ì „ ë³€ê²½
# ì˜ˆ: postgres:15-alpine â†’ postgres:16-alpine

# 3. ì»¨í…Œì´ë„ˆ ì¬ìƒì„±
docker compose stop postgres
docker compose rm -f postgres
docker compose up -d postgres

# 4. ë°±ì—…ì—ì„œ ë³µì› (í•„ìš” ì‹œ)
docker exec -i ad-hub-postgres-database psql -U postgres adhub < backup_YYYYMMDD.sql
```

**âš ï¸ ì£¼ì˜ì‚¬í•­:**
- ë°ì´í„°ë² ì´ìŠ¤ ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘ ì‹œ App ì»¨í…Œì´ë„ˆëŠ” ìë™ìœ¼ë¡œ ì¬ì—°ê²°ë©ë‹ˆë‹¤
- ë°ì´í„°ëŠ” ë³¼ë¥¨ì— ì €ì¥ë˜ë¯€ë¡œ ì»¨í…Œì´ë„ˆ ì¬ìƒì„±í•´ë„ ë°ì´í„°ëŠ” ìœ ì§€ë©ë‹ˆë‹¤
- ë²„ì „ ì—…ê·¸ë ˆì´ë“œ ì „ ë°˜ë“œì‹œ ë°±ì—…ì„ ìˆ˜í–‰í•˜ì„¸ìš”

### ì „ì²´ ì»¨í…Œì´ë„ˆ ì—…ë°ì´íŠ¸

ëª¨ë“  ì»¨í…Œì´ë„ˆë¥¼ ì¬ë¹Œë“œí•˜ê³  ì¬ì‹œì‘í•©ë‹ˆë‹¤.

```bash
# ì „ì²´ ì¤‘ì§€
docker compose down

# ì „ì²´ ì¬ë¹Œë“œ ë° ì‹œì‘
docker compose up -d --build

# ë˜ëŠ” ë‹¨ê³„ë³„
docker compose build          # ëª¨ë“  ì„œë¹„ìŠ¤ ë¹Œë“œ
docker compose up -d          # ëª¨ë“  ì„œë¹„ìŠ¤ ì‹œì‘
```

### ì—…ë°ì´íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ë³„ ê°€ì´ë“œ

#### ì‹œë‚˜ë¦¬ì˜¤ 1: ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ ë³€ê²½

```bash
# 1. ì½”ë“œ ë³€ê²½ í›„
cd /volume1/docker/ad-hub

# 2. App ì»¨í…Œì´ë„ˆë§Œ ì¬ë¹Œë“œ
docker compose up -d --build app

# 3. ë¡œê·¸ í™•ì¸
docker compose logs -f app
```

#### ì‹œë‚˜ë¦¬ì˜¤ 2: ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ë³€ê²½

```bash
# 1. prisma/schema.prisma ìˆ˜ì • í›„

# 2. ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ìƒì„± (ë¡œì»¬ì—ì„œ)
npx prisma migrate dev --name your_migration_name

# 3. ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ì„ ì„œë²„ì— ì—…ë¡œë“œ

# 4. App ì»¨í…Œì´ë„ˆì—ì„œ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰
docker exec -it adhub-app npx prisma migrate deploy

# ë˜ëŠ” App ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘ (entrypoint.shê°€ ìë™ ì‹¤í–‰)
docker compose restart app
```

#### ì‹œë‚˜ë¦¬ì˜¤ 3: í™˜ê²½ ë³€ìˆ˜ ë³€ê²½

```bash
# 1. .env íŒŒì¼ ìˆ˜ì •

# 2. App ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘ (í™˜ê²½ ë³€ìˆ˜ ì¬ë¡œë“œ)
docker compose restart app

# ë˜ëŠ” ì „ì²´ ì¬ì‹œì‘
docker compose down
docker compose up -d
```

#### ì‹œë‚˜ë¦¬ì˜¤ 4: ì˜ì¡´ì„± íŒ¨í‚¤ì§€ ì¶”ê°€/ë³€ê²½

```bash
# 1. package.json ìˆ˜ì • í›„

# 2. App ì»¨í…Œì´ë„ˆ ì¬ë¹Œë“œ (ì˜ì¡´ì„± ì¬ì„¤ì¹˜)
docker compose up -d --build app
```

---

## âš™ï¸ ì£¼ìš” ì„¤ì • íŒŒì¼ ì„¤ëª…

### docker-compose.yml

Docker Compose ì„¤ì • íŒŒì¼ë¡œ ë‹¤ìŒ ì„œë¹„ìŠ¤ë¥¼ ì •ì˜í•©ë‹ˆë‹¤:

1. **init**: ë³¼ë¥¨ ë””ë ‰í† ë¦¬ ìë™ ìƒì„±
2. **app**: Next.js ì• í”Œë¦¬ì¼€ì´ì…˜
3. **postgres**: PostgreSQL ë°ì´í„°ë² ì´ìŠ¤

**ì£¼ìš” ì„¤ì •:**
- ë„¤íŠ¸ì›Œí¬: `adhub-network` (bridge)
- ë³¼ë¥¨: ë°ì´í„°ë² ì´ìŠ¤ ë°ì´í„° ì˜êµ¬ ì €ì¥
- Health check: ì»¨í…Œì´ë„ˆ ìƒíƒœ ëª¨ë‹ˆí„°ë§
- ì˜ì¡´ì„±: Appì€ Postgresê°€ ì¤€ë¹„ëœ í›„ ì‹œì‘

### Dockerfile

ë©€í‹° ìŠ¤í…Œì´ì§€ ë¹Œë“œë¡œ ìµœì í™”ëœ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤:

1. **deps**: ì˜ì¡´ì„± ì„¤ì¹˜
2. **prisma**: Prisma Client ìƒì„±
3. **builder**: Next.js ë¹Œë“œ
4. **runner**: í”„ë¡œë•ì…˜ ëŸ°íƒ€ì„

**ìµœì í™” í¬ì¸íŠ¸:**
- Alpine Linux ê¸°ë°˜ìœ¼ë¡œ ì´ë¯¸ì§€ í¬ê¸° ìµœì†Œí™”
- ë©€í‹° ìŠ¤í…Œì´ì§€ ë¹Œë“œë¡œ ë¶ˆí•„ìš”í•œ íŒŒì¼ ì œì™¸
- í”„ë¡œë•ì…˜ ì˜ì¡´ì„±ë§Œ í¬í•¨

### entrypoint.sh

ì»¨í…Œì´ë„ˆ ì‹œì‘ ì‹œ ìë™ ì‹¤í–‰ë˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤:

1. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ëŒ€ê¸°
2. Prisma Client ìƒì„±
3. ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰
4. ì´ˆê¸° ë°ì´í„° ì‹œë“œ
5. Next.js ì•± ì‹œì‘

### .env

í™˜ê²½ ë³€ìˆ˜ ì„¤ì • íŒŒì¼ (Gitì— ì»¤ë°‹í•˜ì§€ ì•ŠìŒ):

```env
# ë°ì´í„°ë² ì´ìŠ¤
DATABASE_URL="postgresql://postgres:password@postgres:5432/adhub?schema=public"
POSTGRES_PASSWORD="your_password"

# NextAuth
NEXTAUTH_SECRET="your_secret"
NEXTAUTH_URL="http://your-domain:5412"

# ì‹œë“œ ë°ì´í„°
SEED_ADMIN_LOGIN_ID="admin"
SEED_ADMIN_PASSWORD="admin123"
```

---

## ğŸ“ ì²´í¬ë¦¬ìŠ¤íŠ¸

### App ì»¨í…Œì´ë„ˆ ì—…ë°ì´íŠ¸ ì‹œ

- [ ] ì½”ë“œ ë³€ê²½ ì‚¬í•­ í™•ì¸
- [ ] ë§ˆì´ê·¸ë ˆì´ì…˜ í•„ìš” ì—¬ë¶€ í™•ì¸
- [ ] í™˜ê²½ ë³€ìˆ˜ ë³€ê²½ ì—¬ë¶€ í™•ì¸
- [ ] ì˜ì¡´ì„± ë³€ê²½ ì—¬ë¶€ í™•ì¸
- [ ] ë¹Œë“œ ì„±ê³µ í™•ì¸
- [ ] ë¡œê·¸ í™•ì¸
- [ ] ì›¹ ë¸Œë¼ìš°ì € ì ‘ì† í…ŒìŠ¤íŠ¸

### ë°ì´í„°ë² ì´ìŠ¤ ì»¨í…Œì´ë„ˆ ì—…ë°ì´íŠ¸ ì‹œ

- [ ] ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—… ìˆ˜í–‰
- [ ] ë³¼ë¥¨ ê²½ë¡œ í™•ì¸
- [ ] í™˜ê²½ ë³€ìˆ˜ í™•ì¸
- [ ] ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
- [ ] App ì»¨í…Œì´ë„ˆ ì—°ê²° í™•ì¸
- [ ] ë°ì´í„° ë¬´ê²°ì„± í™•ì¸

---

## ğŸ”— ê´€ë ¨ ë¬¸ì„œ

- [Docker ë°°í¬ ê°€ì´ë“œ](./DOCKER_DEPLOYMENT_GUIDE.md)
- [ì„œë²„ ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ](./MIGRATION_GUIDE.md)

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-01-15

